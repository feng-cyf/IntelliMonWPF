<UserControl x:Class="IntelliMonWPF.Views.Settings.CreatDeviceUC"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:IntelliMonWPF.Views.Settings"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" xmlns:i1="http://schemas.microsoft.com/xaml/behaviors" xmlns:i2="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             mc:Ignorable="d"
             xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
             Height="600" Width="400">
    <Grid Margin="10">
        <!-- 定义行布局，避免重叠 -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- 标题 -->
            <RowDefinition Height="Auto"/>
            <!-- 连接方式选择 -->
            <RowDefinition Height="*"/>
            <!-- 配置内容区域 -->
            <RowDefinition Height="Auto"/>
            <!-- 按钮区域 -->
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <TextBlock Grid.Row="0" Text="Connection Setup" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>

        <!-- 连接方式选择 -->
        <StackPanel Grid.Row="1" Margin="0,0,0,15">
            <TextBlock Text="Connection" FontWeight="SemiBold" Margin="0,5,0,2"/>
            <ComboBox SelectedItem="{Binding SelectModbus}" x:Name="cboConnection" Width="200" SelectionChanged="cboConnection_SelectionChanged" ItemsSource="{Binding Modbus}" DisplayMemberPath="Value" SelectedValuePath="Key">
            </ComboBox>
            
        </StackPanel>

        <!-- 配置内容区域 -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- 串口参数区域 -->
                <StackPanel x:Name="pnlSerial" IsEnabled="True">
                    <TextBlock Text="Serial Settings" FontWeight="SemiBold" Margin="0,5,0,5"/>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="COM Port" Width="80" VerticalAlignment="Center"/>
                        <ComboBox x:Name="cboCOMPort" Width="120" ItemsSource="{Binding PortName}" SelectedItem="{Binding SelectPortName}">
                            
                        </ComboBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Baud Rate" Width="80" VerticalAlignment="Center"/>
                        <ComboBox x:Name="cboBaudRate" Width="120" ItemsSource="{Binding BaudRates}" SelectedItem="{Binding SelectedBaudRate}"></ComboBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Data Bits" Width="80" VerticalAlignment="Center"/>
                        <ComboBox x:Name="cboDataBits" Width="120" ItemsSource="{Binding DataBitsList}" SelectedItem="{Binding SelectedDataBits}"></ComboBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Parity" Width="80" VerticalAlignment="Center"/>
                        <ComboBox x:Name="cboParity" Width="120" ItemsSource="{Binding Parities}" SelectedItem="{Binding SelectedParity}"></ComboBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Stop Bits" Width="80" VerticalAlignment="Center"/>
                        <ComboBox x:Name="cboStopBits" Width="120" ItemsSource="{Binding StopBitsList}" SelectedItem="{Binding SelectedStopBits}"></ComboBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Mode" Width="80" VerticalAlignment="Center"/>
                        <RadioButton x:Name="rdoRTU" Content="RTU" Margin="5,0" IsChecked="{Binding SerialPortType}"/>
                        <RadioButton x:Name="rdoASCII" Content="ASCII" Margin="5,0"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Flow Control" Width="80" VerticalAlignment="Center"/>
                        <CheckBox x:Name="chkDSR" Content="DSR" Margin="5,0"/>
                        <CheckBox x:Name="chkCTS" Content="CTS" Margin="5,0"/>
                        <CheckBox x:Name="chkRTS" Content="RTS Toggle" Margin="5,0" IsChecked="True"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="RTS Delay" Width="80" VerticalAlignment="Center"/>
                        <TextBox x:Name="txtRTSDelay" Width="60" Text="{Binding RTSDeily}" HorizontalContentAlignment="Right"/>
                        <TextBlock Text="ms" VerticalAlignment="Center" Margin="2,0"/>
                    </StackPanel>
                </StackPanel>

                <!-- TCP/IP 参数区域 -->
                <StackPanel x:Name="pnlTCP" IsEnabled="False">
                    <TextBlock Text="TCP/IP Server" FontWeight="SemiBold" Margin="0,5,0,5"/>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="IP Address" Width="80" VerticalAlignment="Center"/>
                        <ComboBox x:Name="txtIP" Width="150" ItemsSource="{Binding IpAdressList}" SelectedItem="{Binding IpAdresss}" IsEnabled="{Binding CanWriteIPText}"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <TextBlock Text="Port" Width="80" VerticalAlignment="Center"/>
                        <TextBox x:Name="txtPort" Width="150" Text="{Binding Port}" HorizontalContentAlignment="Right"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <CheckBox x:Name="chkAnyAddress" Content="Any Address" Margin="0,2" IsChecked="{Binding CanWriteIP}"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <RadioButton x:Name="rdoIPv4" Content="IPv4" Margin="5,0" IsChecked="True"/>
                        <RadioButton x:Name="rdoIPv6" Content="IPv6" Margin="5,0"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,5">
                        <CheckBox x:Name="chkIgnoreUnitID" Content="Ignore Unit ID" Margin="0,2"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- 确认/取消按钮 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button x:Name="btnOK" Content="OK" Width="60" Margin="0,0,10,0" Command="{Binding AddDeviceCmd}"/>
            <Button x:Name="btnCancel" Content="Cancel" Width="80" Command="{Binding CloseCmd}"/>
        </StackPanel>

        <!-- 交互逻辑：切换连接方式时显示/隐藏对应面板 -->
       
    </Grid>
</UserControl>